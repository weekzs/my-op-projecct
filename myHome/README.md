# 🚴‍♂️ 智能骑行助手

一个为宁波到九江长途骑行设计的智能导航助手，提供实时导航、天气预警、住宿规划和AI智能建议。

## 📱 功能特性

### ✅ 已完成功能（第一、二阶段）

#### 🗺️ 地图与导航
- **天地图API集成**：使用天地图JavaScript API 4.0
- **实时定位**：每5分钟自动更新GPS位置
- **路线显示**：显示宁波→九江完整路线和途经点
- **交互式地图**：支持缩放、拖动、全屏等操作
- **标记管理**：起点、终点、途经点、当前位置标记

#### 🌤️ 天气服务
- **实时天气**：基于天地图天气API的实时天气数据
- **天气预警**：恶劣天气自动预警和建议
- **骑行建议**：根据天气条件提供骑行建议
- **缓存机制**：30分钟智能缓存，减少API调用

#### 💾 数据管理
- **本地存储**：基于LocalStorage的完整数据管理
- **用户配置**：个性化设置和偏好管理
- **行程数据**：实时记录和管理骑行数据
- **离线支持**：基础离线功能和数据缓存

#### 🎨 用户界面
- **响应式设计**：完美适配手机和平板
- **触摸友好**：支持触摸手势和操作
- **PWA支持**：可安装到主屏幕，支持离线使用
- **深色模式**：自动适配系统主题

#### 🚨 安全功能
- **紧急求助**：一键紧急求助面板
- **位置分享**：快速分享当前位置
- **紧急联系人**：管理和拨打紧急联系人
- **离线应急**：网络断开时的应急功能

### 🚧 开发中功能（第三阶段）

#### 🤖 AI智能助手
- **DeepSeek AI集成**：智能决策和建议生成
- **每小时评估**：自动分析进度和环境因素
- **个性化学习**：学习用户偏好，提供个性化建议
- **自动执行**：大部分调整自动执行，减少用户操作

#### 📊 智能分析
- **进度分析**：实时分析骑行进度和体力状况
- **风险评估**：多维度安全风险评估
- **动态调整**：智能调整路线、住宿和休息计划
- **学习优化**：基于用户选择不断优化建议质量

### 📋 计划功能（第四阶段）

#### ⚡ 性能优化
- **离线地图**：完整离线地图支持
- **电量优化**：智能电量管理和省电模式
- **缓存优化**：更智能的数据缓存策略
- **网络优化**：弱网环境下的优化体验

#### 🏨 住宿服务
- **住宿查找**：基于位置的住宿推荐
- **价格比较**：多家住宿价格对比
- **预订集成**：一键拨打预订电话
- **用户评价**：住宿质量和安全评分

## 🚀 快速开始

### 环境要求
- 现代浏览器（Chrome 80+, Safari 13+, Firefox 75+）
- HTTPS环境（PWA要求）
- GPS定位权限
- 网络连接（支持离线使用）

### 安装部署
1. **克隆项目**
```bash
git clone <repository-url>
cd myHome
```

2. **启动本地服务器**
```bash
# 使用Python
python -m http.server 8000

# 或使用Node.js
npx serve .

# 或使用Live Server（VS Code）
```

3. **访问应用**
```
https://localhost:8000
```

4. **安装PWA**
- 在浏览器中访问应用
- 点击"安装"或"添加到主屏幕"
- 按照提示完成安装

### 配置设置
1. **首次使用**
- 允许定位权限
- 设置每日预算（默认100元）
- 设置偏好出发时间（默认08:00）
- 添加紧急联系人

2. **路线确认**
- 确认起点：宁波
- 确认终点：九江
- 检查途经点设置

3. **开始骑行**
- 点击"开始行程"
- 系统将自动开始定位和追踪
- 查看地图和实时状态

## 📁 项目结构

```
myHome/
├── index.html              # 主页面
├── styles.css              # 样式文件
├── manifest.json           # PWA配置
├── sw.js                   # Service Worker
├── js/
│   ├── config.js           # 应用配置
│   ├── storage.js          # 数据管理
│   ├── map.js              # 地图管理
│   ├── location.js         # 定位服务
│   ├── weather.js          # 天气服务
│   ├── ui.js               # UI管理
│   └── app.js              # 主应用
├── 需求文档.md              # 详细需求文档
└── README.md               # 项目说明
```

## 🔧 技术栈

### 前端技术
- **HTML5**：语义化标签，现代Web标准
- **CSS3**：响应式设计，动画效果，Grid/Flexbox布局
- **JavaScript ES6+**：模块化开发，现代JavaScript特性

### 地图服务
- **天地图API 4.0**：官方地图服务
- **矢量地图**：高清矢量地图显示
- **卫星地图**：可选卫星图层

### 天气服务
- **天地图天气API**：实时天气数据
- **天气预警**：恶劣天气自动预警
- **预报数据**：5天天气预报

### AI服务
- **DeepSeek API**：智能决策和建议生成
- **自然语言处理**：理解和生成自然语言建议
- **机器学习**：个性化学习和偏好分析

### 存储技术
- **LocalStorage**：本地数据存储
- **IndexedDB**：离线数据管理（计划中）
- **Service Worker**：离线缓存和同步

### PWA技术
- **Web App Manifest**：应用配置
- **Service Worker**：离线支持和缓存管理
- **Push API**：推送通知（计划中）

## 📊 API配置

### 天地图API
```javascript
const TIANDITU_CONFIG = {
  MAP_KEY: "b9dba51939890c06d308032e54dd8c71",
  WEATHER_KEY: "1d558b2a4b64bd56595789e1828f3a45",
  BASE_URL: "https://api.tianditu.gov.cn"
};
```

### DeepSeek AI
```javascript
const DEEPSEEK_CONFIG = {
  API_KEY: "sk-14dd8e7224024b758b8dae6db81d9299",
  BASE_URL: "https://api.deepseek.com/v1",
  MODEL: "deepseek-chat"
};
```

## 🛣️ 路线规划

### 主路线
宁波 → 杭州湾跨海大桥 → 嘉兴 → 杭州 → 黄山 → 景德镇 → 九江

### 每日计划
- **第1天**：宁波-嘉兴（约150公里）
- **第2天**：嘉兴-杭州（约100公里）
- **第3天**：杭州-黄山（约150公里）
- **第4天**：黄山-景德镇（约180公里）
- **第5天**：景德镇-九江（约156公里）

### 总体数据
- **总距离**：686公里
- **预计时间**：5-7天
- **难度等级**：中等（包含山区路段）

## 🔒 隐私与安全

### 数据隐私
- **本地存储**：所有数据存储在设备本地
- **最小权限**：只请求必要的系统权限
- **透明政策**：明确说明数据用途和存储方式

### 安全保障
- **HTTPS传输**：所有数据传输加密
- **权限控制**：细粒度的功能权限管理
- **紧急保护**：紧急情况下的安全机制

## 🐛 问题反馈

### 常见问题
1. **定位不准确**：确保GPS已开启，在空旷区域使用
2. **地图加载慢**：检查网络连接，尝试刷新页面
3. **天气数据异常**：可能是API限制，稍后重试
4. **离线功能受限**：首次使用需要联网缓存数据

### 反馈渠道
- GitHub Issues：项目仓库提交问题
- 邮件反馈：发送问题描述到指定邮箱
- 应用内反馈：通过设置页面提交反馈

## 📈 开发进度

### ✅ 第一阶段：基础框架（已完成）
- [x] HTML页面结构和响应式布局
- [x] 天地图API集成和地图显示
- [x] LocalStorage数据存储基础结构

### ✅ 第二阶段：核心功能（已完成）
- [x] 实时定位和轨迹记录
- [x] 天气服务和预警系统
- [x] 基础路线规划和进度计算
- [x] 用户界面和交互管理
- [x] PWA离线功能

### 🚧 第三阶段：AI智能（开发中）
- [ ] DeepSeek API集成
- [ ] 智能决策引擎实现
- [ ] 个性化学习算法
- [ ] 小时评估循环机制

### 📋 第四阶段：优化完善（计划中）
- [ ] 离线功能增强
- [ ] 紧急情况处理
- [ ] 性能优化与测试
- [ ] 用户体验优化

## 🤝 贡献指南

### 开发环境
1. 使用现代编辑器（VS Code推荐）
2. 安装Live Server等本地服务器扩展
3. 配置Git版本控制

### 代码规范
- 使用ES6+现代JavaScript语法
- 遵循模块化开发原则
- 保持代码注释完整
- 进行充分的测试

### 提交规范
- 使用语义化提交信息
- 提供清晰的变更说明
- 包含相关测试用例
- 更新相关文档

## 📄 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

## 🙏 致谢

感谢以下服务和技术的支持：
- 天地图API提供的地图和天气服务
- DeepSeek AI提供的智能决策支持
- PWA技术栈提供的离线能力
- 开源社区的技术贡献

---

**版本**：v1.0.0-alpha  
**最后更新**：2026-02-01  
**维护团队**：智能骑行助手开发团队